function [gradgrad] = localGradGradMatrix (fem,flag)

switch fem
    case 'P1'
        % Linear Lagrangian elements on triangle
        DERXX = [ 1, -1, 0; ...
                 -1,  1, 0; ...
                  0,  0, 0]/2;
        DERYY = [ 1, 0, -1; ...
                  0, 0,  0; ...
                 -1, 0,  1]/2;
        DERXY = [ 1, 0, -1; ...
                 -1, 0,  1; ...
                  0, 0,  0]/2;
    case 'P2'
        % Quadratic Lagrangian elements on triangle
        DERXX = [ 3,  1, 0, -4,  0,  0; ...
                  1,  3, 0, -4,  0,  0; ...
                  0,  0, 0,  0,  0,  0; ...
                 -4, -4, 0,  8,  0,  0; ...
                  0,  0, 0,  0,  8, -8; ...
                  0,  0, 0,  0, -8,  8]/6;
        DERYY = [ 3, 0,  1,  0,  0, -4; ...
                  0, 0,  0,  0,  0,  0; ...
                  1, 0,  3,  0,  0, -4; ...
                  0, 0,  0,  8, -8,  0; ...
                  0, 0,  0, -8,  8,  0; ...
                 -4, 0, -4,  0,  0,  8]/6;
        DERXY = [ 3, 0,  1,  0,  0, -4; ...
                  1, 0, -1, -4,  4,  0; ...
                  0, 0,  0,  0,  0,  0; ...
                 -4, 0,  0,  4, -4,  4; ...
                  0, 0,  4, -4,  4, -4; ...
                  0, 0, -4,  4, -4,  4]/6;
    case 'P3'
        DERXX = [                                                                17/40,                                                               -851861203353370160620534321119187/9735556609752801803494680617287680,                                                                -126100789566373457/77884452878022414427957444938301440, -27/40,                                                               34226566206162191705892413156013/101412048018258352119736256430080,                                                               -162129586585337879/4323455642275676160,                                                              -108086391056891913/2882303761517117440,                                                                 22817710804108132815746610757633/608472288109550112718417538580480,                                                               3/80,                                                    0; ...
                 -851861203353370160620534321119187/9735556609752801803494680617287680, 25176219727014452479224973118070010304972913868540675436005924469/59238164063563417517578890572064618179378491162808875080549924864,  3836441797993602012598679818570041674930845608371/2369526562542536700703155622882584727175139646512355003221996994560,  27/80, -555357788095907021910030094280818471610796171667185578106526107/822752278660603021077484591278675252491367932816789931674304512, 6576757367989066620491033575277460843269747376197/175380196479708350184442179925953962358711905157120, 1096126227998176321579753068429681431332792565577/29230032746618058364073696654325660393118650859520, -694197235119883301281494792688778946583166574773558514588581827/18511926269863567974243403303770193181055778488377773462671851520, -7605903601369381686636032557059/202824096036516704239472512860160, 18577348462903623/1622592768292133633915780102881280; ...
                               -126100789566373457/77884452878022414427957444938301440,               3836441797993602012598679818570041674930845608371/2369526562542536700703155622882584727175139646512355003221996994560,              114210248478161907395706250763138977/18956212500340293605625244983060677817401117172098840025775975956480,      0,                               211486375138075419486680923505319/6582018229284824168619876730229402019930943462534319453394436096,             -39429004269498643624356709041996473/1403041571837666801475537439407631698869695241256960,              23365335863406657625573152497073651/233840261972944466912589573234605283144949206876160,             -14797704077975349962396944604320989169891166650193/148095410158908543793947226430161545448446227907022187701374812160,                                             81/2882303761517117440,            -1779/12980742146337069071326240823050240; ...
                                                                                -27/40,                                                                                                                               27/80,                                                                                                                      0,  27/16,                                                                                                                           -27/20,                                                                                                     0,                                                                                                    0,                                                                                                                                  0,                                                                  0,                                                    0; ...
                    34226566206162191705892413156013/101412048018258352119736256430080,    -555357788095907021910030094280818471610796171667185578106526107/822752278660603021077484591278675252491367932816789931674304512,                     211486375138075419486680923505319/6582018229284824168619876730229402019930943462534319453394436096, -27/20,   108468317987481843599082441233042144178869131695863842552326843/64277521770359611021678483693646504100888119751311713412055040,                                    49093927187950197/913438523331814323877303020447676887284957839360,                 2076411683173837547469389137182657/3653754093327257295509212081790707549139831357440,                  -146114482540772490759739360463414377716376753491/257110087081438444086713934774586016403552479005246853648220160,                                                                  0,                                                    0; ...
                                               -162129586585337879/4323455642275676160,                               6576757367989066620491033575277460843269747376197/175380196479708350184442179925953962358711905157120,                              -39429004269498643624356709041996473/1403041571837666801475537439407631698869695241256960,      0,                                                               49093927187950197/913438523331814323877303020447676887284957839360,                               65715007115831412173589094166692369/38942226439011207213978722469150720,                             -17524001897555032869996883649494833/51922968585348276285304963292200960,                               3699426019493845273577780739837177358915064561641/10961262279981771886527636245372122647419494072320,                                                              27/80,                                               -81/40; ...
                                               -108086391056891913/2882303761517117440,                                1096126227998176321579753068429681431332792565577/29230032746618058364073696654325660393118650859520,                                23365335863406657625573152497073651/233840261972944466912589573234605283144949206876160,      0,                                             2076411683173837547469389137182657/3653754093327257295509212081790707549139831357440,                              -17524001897555032869996883649494833/51922968585348276285304963292200960,                                8762000948777521914978468409167069/5192296858534827628530496329220096,                               -3082855016244873491401017920713787257716631142403/1826877046663628647754606040895353774569915678720,                                                              27/80,                              -81/1441151880758558720; ...
                    22817710804108132815746610757633/608472288109550112718417538580480,  -694197235119883301281494792688778946583166574773558514588581827/18511926269863567974243403303770193181055778488377773462671851520, -14797704077975349962396944604320989169891166650193/148095410158908543793947226430161545448446227907022187701374812160,      0,                -146114482540772490759739360463414377716376753491/257110087081438444086713934774586016403552479005246853648220160,  3699426019493845273577780739837177358915064561641/10961262279981771886527636245372122647419494072320, -3082855016244873491401017920713787257716631142403/1826877046663628647754606040895353774569915678720,    390485944754934661523197699140246386347517554098133308642479309/231399078373294599678042541297127414763197231104722168283398144,                                                             -27/80,    2153283571836519/20282409603651670423947251286016; ...
                                                                                  3/80,                                                                  -7605903601369381686636032557059/202824096036516704239472512860160,                                                                                                 81/2882303761517117440,      0,                                                                                                                                0,                                                                                                 27/80,                                                                                                27/80,                                                                                                                             -27/80,                                                              27/16,                                               -81/40; ...
                                                                                     0,                                                                                18577348462903623/1622592768292133633915780102881280,                                                                              -1779/12980742146337069071326240823050240,      0,                                                                                                                                0,                                                                                                -81/40,                                                                              -81/1441151880758558720,                                                                                  2153283571836519/20282409603651670423947251286016,                                                             -81/40,                                                81/20];


        DERYY = [                                                                  17/40,                                                                 -562949953421303/1947111321950560360698936123457536,                                                                 -6814889626826961388547065998474833/77884452878022414427957444938301440,                                                3/80,                                                                 3802951800684686069971536226989/101412048018258352119736256430080,                                                                -162129586585337879/4323455642275676160,                                                                -108086391056891913/2882303761517117440,                                                                  205359397236973166631271872331777/608472288109550112718417538580480, -27/40,                                                   0; ...
                                     -562949953421303/1947111321950560360698936123457536,               1852988264883606308978669377306763/592381640635634175175788905720646181793784911628088750805499248640,                     152239753888630846952209492617211002080111732921/526561458342785933489590138418352161594475477002745556271554887680, -5277655813324803/202824096036516704239472512860160,                -177692337741891154347314668759406411302431388023/4113761393303015105387422956393376262456839664083949658371522560,                22726439960891583460827815347222207/526140589439125050553326539777861887076135715471360,                 -3589986499846341230118930424529517/58460065493236116728147393308651320786237301719040,                                    -8889399834100411629453274041535/2468256835981809063232453773836025757474103798450369795022913536,      0,   4433230883192829/50706024009129176059868128215040; ...
                 -6814889626826961388547065998474833/77884452878022414427957444938301440, 152239753888630846952209492617211002080111732921/526561458342785933489590138418352161594475477002745556271554887680, 1790308958365472187505288419044144645611990003876678911386602178699/4212491666742287467916721107346817292755803816021964450172439101440,             -108086391056891823/2882303761517117440, -246825683598180493753512339181384321295731414338310613607650649/6582018229284824168619876730229402019930943462534319453394436096, 17538019647970818035306576534973362553787256458349/467680523945888933825179146469210566289898413752320, 17538019647970889537561232608174288420483987669721/467680523945888933825179146469210566289898413752320, -66642934571508845289593310517604279069771319478126240096275398737/98730273439272362529298150953441030298964151938014791800916541440,  27/80,  -1794402976530429/12676506002282294014967032053760; ...
                                                                                    3/80,                                                                 -5277655813324803/202824096036516704239472512860160,                                                                                                 -108086391056891823/2882303761517117440,                                               27/16,                                                                                                                            -27/80,                                                                                                  27/80,                                                                                                  27/80,                                                                                                                                    0,      0,                                              -81/40; ...
                       3802951800684686069971536226989/101412048018258352119736256430080,  -177692337741891154347314668759406411302431388023/4113761393303015105387422956393376262456839664083949658371522560,       -246825683598180493753512339181384321295731414338310613607650649/6582018229284824168619876730229402019930943462534319453394436096,                                              -27/80,     54234158993740909623334342218811869057464713788054700032932073/32138760885179805510839241846823252050444059875655856706027520,     -770713754061218271121293811863106108264598499801/456719261665907161938651510223838443642478919680,    1233142006497950413469718671369670091062399467457/3653754093327257295509212081790707549139831357440,                        8188833636900445567268403540944020696302389385/51422017416287688817342786954917203280710495801049370729644032,      0, -19210667160502251/50706024009129176059868128215040; ...
                                                 -162129586585337879/4323455642275676160,                             22726439960891583460827815347222207/526140589439125050553326539777861887076135715471360,                                  17538019647970818035306576534973362553787256458349/467680523945888933825179146469210566289898413752320,                                               27/80,                                -770713754061218271121293811863106108264598499801/456719261665907161938651510223838443642478919680,                                98572510673747123853854378444194321/58413339658516810820968083703726080,                               -17524001897555033896817598689967921/51922968585348276285304963292200960,                                                 -349110975302854490958451398043243/2192252455996354377305527249074424529483898814464,      0,                              -69/720575940379279360; ...
                                                 -108086391056891913/2882303761517117440,                              -3589986499846341230118930424529517/58460065493236116728147393308651320786237301719040,                                  17538019647970889537561232608174288420483987669721/467680523945888933825179146469210566289898413752320,                                               27/80,                               1233142006497950413469718671369670091062399467457/3653754093327257295509212081790707549139831357440,                               -17524001897555033896817598689967921/51922968585348276285304963292200960,                                87620009487775216231452125555589363/51922968585348276285304963292200960,                                                                   -6459850715509557/730750818665451459101842416358141509827966271488,      0,                                              -81/40; ...
                     205359397236973166631271872331777/608472288109550112718417538580480,                   -8889399834100411629453274041535/2468256835981809063232453773836025757474103798450369795022913536,    -66642934571508845289593310517604279069771319478126240096275398737/98730273439272362529298150953441030298964151938014791800916541440,                                                   0,                     8188833636900445567268403540944020696302389385/51422017416287688817342786954917203280710495801049370729644032,                   -349110975302854490958451398043243/2192252455996354377305527249074424529483898814464,                                     -6459850715509557/730750818665451459101842416358141509827966271488,      260323963169956424637797858959270917514230630013523971797732557/154266052248863066452028360864751609842131487403148112188932096, -27/20,                                                   0; ...
                                                                                  -27/40,                                                                                                                   0,                                                                                                                                   27/80,                                                   0,                                                                                                                                 0,                                                                                                      0,                                                                                                      0,                                                                                                                               -27/20,  27/16,                                                   0; ...
                                                                                       0,                                                                   4433230883192829/50706024009129176059868128215040,                                                                                      -1794402976530429/12676506002282294014967032053760,                                              -81/40,                                                                               -19210667160502251/50706024009129176059868128215040,                                                                                 -69/720575940379279360,                                                                                                 -81/40,                                                                                                                                    0,      0,                                               81/20];


        DERXY = [                                                                17/40,                                                                    -562949953421303/1947111321950560360698936123457536,                                                                -6814889626826961388547065998474833/77884452878022414427957444938301440,                                                                3/80,                                                                3802951800684686069971536226989/101412048018258352119736256430080,                                                               -162129586585337879/4323455642275676160,                                                                 -108086391056891913/2882303761517117440,                                                             205359397236973166631271872331777/608472288109550112718417538580480,                                              -27/40,                                                                   0; ...
                 -851861203353370160620534321119187/9735556609752801803494680617287680, 24388808572959335794691478394042749706764661305163/1184763281271268350351577811441292363587569823256177501610998497280, 165866859377977485853240188540325787076830386341367952935198150853/1895621250034029360562524498306067781740111717209884002577597595648, 121694457621910017266027694391293/405648192073033408478945025720320, -146552749636419910298719018954679046131596370258429310777763785/205688069665150755269371147819668813122841983204197482918576128, 18743758498768830257579654999288687484957911259265/26307029471956252527666326988893094353806785773568, -35076039295941667298763139492225821973141644116709/116920130986472233456294786617302641572474603438080,            -2093772365199647167252876985010714262032781147913/74047705079454271896973613215080772724223113953511093850687406080, -5277655813324803/405648192073033408478945025720320,                33776997205278879/1622592768292133633915780102881280; ...
                               -126100789566373457/77884452878022414427957444938301440,               -16783693947021690084924659838581399/9478106250170146802812622491530338908700558586049420012887987978240,                373170084731822860284567030375358567674126265467019/8424983333484574935833442214693634585511607632043928900344878202880,                                              81/5764607523034234880,                115607063109182253869236074135362114127552286401/8227522786606030210774845912786752524913679328167899316743045120,               -2957175320212398691337058467709733/210456235775650020221330615911144754830454286188544,                 40402559930474033962753062586026201/935361047891777867650358292938421132579796827504640,            -2240207978471269928226834711259364945869471918813/39492109375708945011719260381376412119585660775205916720366616576,                              81/5764607523034234880,             -743093938516130547/12980742146337069071326240823050240; ...
                                                                                -27/40,                                                                    -5277655813324803/405648192073033408478945025720320,                                                                                                                 81/5764607523034234880,                                                               27/32,                                                                                                                          -27/160,                                                                                                27/160,                                                                                                  27/160,                                                                                                                         -27/160,                                               27/32,                                                              -81/80; ...
                    34226566206162191705892413156013/101412048018258352119736256430080,      -29972201546824818665380754770422113178839620749/4113761393303015105387422956393376262456839664083949658371522560,                    7389337054369647251883160965104146601280220140993/32910091146424120843099383651147010099654717312671597266972180480,                                                            -189/160,  108468317987481843599082441233042144178869131695863842552326843/128555043540719222043356967387293008201776239502623426824110080,  -1541427508122436671542948847005405653366178403723/1826877046663628647754606040895353774569915678720,      616571003248975950211936369540612813276651192299/3653754093327257295509212081790707549139831357440, -43387327194992772496404428583296477942892701087926246909090929/257110087081438444086713934774586016403552479005246853648220160,                                             -27/160,   51339849309243271549949319315477/50706024009129176059868128215040; ...
                                               -162129586585337879/4323455642275676160,                                -4107187944739512390054703416736987/526140589439125050553326539777861887076135715471360,                               -252547482930779943119732396803849430817225802630693/841824943102600080885322463644579019321817144754176,                                                              27/160,                               -308285501624487195881144224478581808180725302351/365375409332725729550921208179070754913983135744,                               13143001423166283926310015418446749/15576890575604482885591488987660288,                                 43810004743887616006032609930903621/51922968585348276285304963292200960,                             1109827805848153390404563467442778677874735552917/6576757367989063131916581747223273588451696443392,                                              27/160,                              -729583139634020421/720575940379279360; ...
                                               -108086391056891913/2882303761517117440,                                  -717997299969268291622732312032113/23384026197294446691258957323460528314494920687616,                                666444746622891786680330789797127718968830596211929/935361047891777867650358292938421132579796827504640,                                                              27/160,                                154142750812243814518677161232043458203895201771/913438523331814323877303020447676887284957839360,                                 -438100047438875883899596948950207/2596148429267413814265248164610048,                                87620009487775222068117242627752179/103845937170696552570609926584401920,                            -1233142006497949337234359077604370257685408592693/1461501637330902918203684832716283019655932542976,                                              27/160,                              -291833255853608157/288230376151711744; ...
                    22817710804108132815746610757633/608472288109550112718417538580480,    2273605574480591491802505000206049005779323715687/74047705079454271896973613215080772724223113953511093850687406080,   -46896879883654376323307958237689340700338340305514748261572920859/65820182292848241686198767302294020199309434625343194533944360960,                                                             -27/160,   -10846831798748193124101107145826034578963949753706990176509041/64277521770359611021678483693646504100888119751311713412055040,    277456951462038434878884692574300900574149319061/1644189341997265782979145436805818397112924110848,    -1233142006497949492394792545539692235438303687477/1461501637330902918203684832716283019655932542976, 260323963169956424637797858959270917514230630013523971797732557/308532104497726132904056721729503219684262974806296224377864192,                                             -27/160, 102679698618486592287650818818051/101412048018258352119736256430080; ...
                                                                                  3/80,                                                                    -5277655813324803/405648192073033408478945025720320,                                                                                                 345876451382054109/1152921504606846976,                                                               27/32,                                                                                                                          -27/160,                                                                                                27/160,                                                                                                  27/160,                                                                                                                        -189/160,                                               27/32,                                                              -81/80; ...
                                                                                     0,                                                                   33776997205278879/1622592768292133633915780102881280,                                                                                -743093938516130547/12980742146337069071326240823050240,                                                              -81/80,                                                                51339849309243271549949319315477/50706024009129176059868128215040,                                                                -729583139634020421/720575940379279360,                                                                  -291833255853608157/288230376151711744,                                                             102679698618486592287650818818051/101412048018258352119736256430080,                                              -81/80,                                                               81/40];
    case 'P3gl'
        DERXX = [                                            91/180,                                                -7/90,                                           1/180,                                                                     - 5^(1/2)/12 - 24716748219179027/50665495807918080,                                                                          5^(1/2)/12 + 450765620734979/6333186975989760,                                                                                    -1473822112022165/20266198323167232,                                                                               -1720221985934167/162129586585337856,                                                    -2150277482417717/202661983231672320,                                               -7369110560110817/101330991615836160,                                               3/20; ...
                                                              -7/90,                                               91/180,                                           1/180,                                                                   (7*5^(1/2))/6 - 119126325502708667/50665495807918080,                                                                    49007851124704721/25332747903959040 - (7*5^(1/2))/6,                                                                                    -1473822112022165/20266198323167232,                                                                               -1720221985934167/162129586585337856,                                                    -2150277482417717/202661983231672320,                                               -7369110560110817/101330991615836160,                                               3/20; ...
                                                              1/180,                                                1/180,                                           1/180,                                                                         1180119716044121/6333186975989760 - 5^(1/2)/12,                                                                        5^(1/2)/12 - 9440957728352963/50665495807918080,                                                                                    -1473822112022165/20266198323167232,                                                                               -1720221985934167/162129586585337856,                                                    -2150277482417717/202661983231672320,                                               -7369110560110817/101330991615836160,                                               3/20; ...
                 - 5^(1/2)/12 - 24716748219179027/50665495807918080, (7*5^(1/2))/6 - 119126325502708667/50665495807918080,  1180119716044121/6333186975989760 - 5^(1/2)/12,    2195113739832293237713063874963771/28522138505135161533675822120960 - (114366631481444431*5^(1/2))/3377699720527872, (881156054646276563*5^(1/2))/27021597764222976 - 16828061718029760452591177997133457/228177108041081292269406576967680,  (117905768961773197*5^(1/2))/54043195528445952 - 1113143380697052076457431369873421/228177108041081292269406576967680, (5734073286447219*5^(1/2))/18014398509481984 - 324810861051757423837326451498717/456354216082162584538813153935360,     (11*5^(1/2))/18014398509481984 - 48967491684754607/91270843216432516907762630787072, 110222937144960227/57044277010270323067351644241920 - (7*5^(1/2))/6755399441055744,   3540359148132363/703687441776640 - (9*5^(1/2))/4; ...
                      5^(1/2)/12 + 450765620734979/6333186975989760,  49007851124704721/25332747903959040 - (7*5^(1/2))/6, 5^(1/2)/12 - 9440957728352963/50665495807918080, (881156054646276563*5^(1/2))/27021597764222976 - 16828061718029760452591177997133457/228177108041081292269406576967680, 65141444429741638735673312470377271/912708432164325169077626307870720 - (423689528720498839*5^(1/2))/13510798882111488, 8905147045576412185173574785255509/1825416864328650338155252615741440 - (117905768961773197*5^(1/2))/54043195528445952, 649621722103513716994867667270887/912708432164325169077626307870720 - (5734073286447219*5^(1/2))/18014398509481984, 2552620609792878077/1825416864328650338155252615741440 - (11*5^(1/2))/18014398509481984,    (7*5^(1/2))/6755399441055744 - 5963873235837377/2852213850513516153367582212096, (9*5^(1/2))/4 - 28322873185058889/5629499534213120; ...
                                -1473822112022165/20266198323167232,                  -1473822112022165/20266198323167232,             -1473822112022165/20266198323167232,  (117905768961773197*5^(1/2))/54043195528445952 - 1113143380697052076457431369873421/228177108041081292269406576967680, 8905147045576412185173574785255509/1825416864328650338155252615741440 - (117905768961773197*5^(1/2))/54043195528445952,                                                  2788831320502104729063701515602467/1825416864328650338155252615741440,                                               507060240091290144699800523225229/3650833728657300676310505231482880,                    507060240091294241895004348427191/3650833728657300676310505231482880,                171652817028663393528260407029397/456354216082162584538813153935360,                 -4421466336066495/2251799813685248; ...
                               -1720221985934167/162129586585337856,                 -1720221985934167/162129586585337856,            -1720221985934167/162129586585337856,     (5734073286447219*5^(1/2))/18014398509481984 - 324810861051757423837326451498717/456354216082162584538813153935360,     649621722103513716994867667270887/912708432164325169077626307870720 - (5734073286447219*5^(1/2))/18014398509481984,                                                   507060240091290144699800523225229/3650833728657300676310505231482880,                                               1394415660251051505414470820110281/912708432164325169077626307870720,                  -2714852228479821496128671253580777/1825416864328650338155252615741440,                 15845632502852906175312659867563/114088554020540646134703288483840,                -5160665957802501/18014398509481984; ...
                               -2150277482417717/202661983231672320,                 -2150277482417717/202661983231672320,            -2150277482417717/202661983231672320,                                    (11*5^(1/2))/18014398509481984 - 48967491684754607/91270843216432516907762630787072,                                2552620609792878077/1825416864328650338155252615741440 - (11*5^(1/2))/18014398509481984,                                                   507060240091294241895004348427191/3650833728657300676310505231482880,                                             -2714852228479821496128671253580777/1825416864328650338155252615741440,                   5577662641004210043002878248822799/3650833728657300676310505231482880,                 15845632502852844459957581327371/114088554020540646134703288483840,                -6450832447253151/22517998136852480; ...
                               -7369110560110817/101330991615836160,                 -7369110560110817/101330991615836160,            -7369110560110817/101330991615836160,                                     110222937144960227/57044277010270323067351644241920 - (7*5^(1/2))/6755399441055744,                                        (7*5^(1/2))/6755399441055744 - 5963873235837377/2852213850513516153367582212096,                                                    171652817028663393528260407029397/456354216082162584538813153935360,                                                 15845632502852906175312659867563/114088554020540646134703288483840,                      15845632502852844459957581327371/114088554020540646134703288483840,                     1089387234571133135571267888203/713053462628379038341895553024,               -22107331680332451/11258999068426240; ...
                                                               3/20,                                                 3/20,                                            3/20,                                                                       3540359148132363/703687441776640 - (9*5^(1/2))/4,                                                                     (9*5^(1/2))/4 - 28322873185058889/5629499534213120,                                                                                     -4421466336066495/2251799813685248,                                                                                -5160665957802501/18014398509481984,                                                     -6450832447253151/22517998136852480,                                               -22107331680332451/11258999068426240,                                              81/20];
         DERYY = [                                            91/180,                                           1/180,                                                -7/90,                                                -7369110560110817/101330991615836160,                                                 -1075138741208857/101330991615836160,                                                                                -8601109929670837/810647932926689280,                                                                                   -102348757779317/1407374883553280,                                                                        5^(1/2)/12 + 1202041655293277/16888498602639360,                                                                    - 5^(1/2)/12 - 24716748219179029/50665495807918080,                                               3/20; ...
                                                               1/180,                                           1/180,                                                1/180,                                                -7369110560110817/101330991615836160,                                                 -1075138741208857/101330991615836160,                                                                                -8601109929670837/810647932926689280,                                                                                   -102348757779317/1407374883553280,                                                                          5^(1/2)/12 - 786746477362747/4222124650659840,                                                                       4720478864176483/25332747903959040 - 5^(1/2)/12,                                               3/20; ...
                                                               -7/90,                                           1/180,                                               91/180,                                                -7369110560110817/101330991615836160,                                                 -1075138741208857/101330991615836160,                                                                                -8601109929670837/810647932926689280,                                                                                   -102348757779317/1407374883553280,                                                                    32671900749803147/16888498602639360 - (7*5^(1/2))/6,                                                                  (7*5^(1/2))/6 - 119126325502708639/50665495807918080,                                               3/20; ...
                                -7369110560110817/101330991615836160,            -7369110560110817/101330991615836160,                 -7369110560110817/101330991615836160,                      1089387234571133557783732954187/713053462628379038341895553024,                     3961408125713215568113927784191/28522138505135161533675822120960,                                                  31691265005705730819827273462599/228177108041081292269406576967680,                                                  57217605676221091157404654279531/152118072027387528179604384645120,                                    (11*5^(1/2))/6755399441055744 - 123831825509751817/38029518006846882044901096161280,                                   147673046801669773/57044277010270323067351644241920 - (11*5^(1/2))/6755399441055744,               -22107331680332451/11258999068426240; ...
                                -1075138741208857/101330991615836160,            -1075138741208857/101330991615836160,                 -1075138741208857/101330991615836160,                    3961408125713215568113927784191/28522138505135161533675822120960,                 1394415660251052935067690796108783/912708432164325169077626307870720,                                               -1357426114239911395023229947529873/912708432164325169077626307870720,                                                  28170013338405231290562775254471/202824096036516704239472512860160,                                   309696533924290351/608472288109550112718417538580480 - (7*5^(1/2))/27021597764222976,                                  (7*5^(1/2))/27021597764222976 - 196054290156068197/228177108041081292269406576967680,                -3225416223626571/11258999068426240; ...
                                -8601109929670837/810647932926689280,            -8601109929670837/810647932926689280,                 -8601109929670837/810647932926689280,                  31691265005705730819827273462599/228177108041081292269406576967680,                -1357426114239911395023229947529873/912708432164325169077626307870720,                                                1394415660251052289004188930977589/912708432164325169077626307870720,                                                169020080030429880394018337022527/1216944576219100225436835077160960,     86616229613801921166679539677581/121694457621910022543683507716096 - (17202219859341671*5^(1/2))/54043195528445952,   (17202219859341671*5^(1/2))/54043195528445952 - 324810861051757113347747842239103/456354216082162584538813153935360,               -25803329789012511/90071992547409920; ...
                                   -102348757779317/1407374883553280,               -102348757779317/1407374883553280,                    -102348757779317/1407374883553280,                  57217605676221091157404654279531/152118072027387528179604384645120,                   28170013338405231290562775254471/202824096036516704239472512860160,                                                169020080030429880394018337022527/1216944576219100225436835077160960,                                                 929610440167367888467336935341801/608472288109550112718417538580480,    395784313136729372216181958036969/81129638414606681695789005144064 - (117905768961773171*5^(1/2))/54043195528445952,   (117905768961773171*5^(1/2))/54043195528445952 - 371047793565683814290261276231153/76059036013693764089802192322560,                 -2763416460041559/1407374883553280; ...
                     5^(1/2)/12 + 1202041655293277/16888498602639360,   5^(1/2)/12 - 786746477362747/4222124650659840,  32671900749803147/16888498602639360 - (7*5^(1/2))/6, (11*5^(1/2))/6755399441055744 - 123831825509751817/38029518006846882044901096161280, 309696533924290351/608472288109550112718417538580480 - (7*5^(1/2))/27021597764222976,  86616229613801921166679539677581/121694457621910022543683507716096 - (17202219859341671*5^(1/2))/54043195528445952, 395784313136729372216181958036969/81129638414606681695789005144064 - (117905768961773171*5^(1/2))/54043195528445952, 17371051847931104206645381811897945/243388915243820045087367015432192 - (847379057440997705*5^(1/2))/27021597764222976, (1762312109292552865*5^(1/2))/54043195528445952 - 3739569270673279568012267846126223/50706024009129176059868128215040,  (9*5^(1/2))/4 - 7080718296264723/1407374883553280; ...
                  - 5^(1/2)/12 - 24716748219179029/50665495807918080, 4720478864176483/25332747903959040 - 5^(1/2)/12, (7*5^(1/2))/6 - 119126325502708639/50665495807918080, 147673046801669773/57044277010270323067351644241920 - (11*5^(1/2))/6755399441055744, (7*5^(1/2))/27021597764222976 - 196054290156068197/228177108041081292269406576967680, (17202219859341671*5^(1/2))/54043195528445952 - 324810861051757113347747842239103/456354216082162584538813153935360, (117905768961773171*5^(1/2))/54043195528445952 - 371047793565683814290261276231153/76059036013693764089802192322560,  (1762312109292552865*5^(1/2))/54043195528445952 - 3739569270673279568012267846126223/50706024009129176059868128215040,   2195113739832292541075608830911021/28522138505135161533675822120960 - (114366631481444395*5^(1/2))/3377699720527872, 14161436592529449/2814749767106560 - (9*5^(1/2))/4; ...
                                                                3/20,                                            3/20,                                                 3/20,                                                -22107331680332451/11258999068426240,                                                  -3225416223626571/11258999068426240,                                                                                -25803329789012511/90071992547409920,                                                                                  -2763416460041559/1407374883553280,                                                                      (9*5^(1/2))/4 - 7080718296264723/1407374883553280,                                                                    14161436592529449/2814749767106560 - (9*5^(1/2))/4,                                              81/20];
         DERXY = [                              181/360,                                 1/360,                                  -29/360,                                                                              -349665101050109/11258999068426240,                                                                                  25175887275607877/810647932926689280,                                                                                  -3752999689475413/90071992547409920,                                                                               -33776997205278707/810647932926689280,                                                                                  467858420766665171/1621295865853378560,                                                                               -17865599451128743/25332747903959040,                                  3/40; ...
                                                -29/360,                                 1/360,                                   31/360,                                                                              2549686608779401/11258999068426240,                                                                                -521347407884904013/810647932926689280,                                                                                  56971810883914787/90071992547409920,                                                                              -121265160156501691/405323966463344640,                                                                                   50351774551215581/1621295865853378560,                                                                               -3146985909450967/101330991615836160,                                  3/40; ...
                                                  1/360,                                 1/360,                                    1/360,                                                                              -349665101050109/11258999068426240,                                                                                  25175887275607877/810647932926689280,                                                                                  -3752999689475413/90071992547409920,                                                                               -33776997205278707/810647932926689280,                                                                                   50351774551215731/1621295865853378560,                                                                                -1573492954725491/50665495807918080,                                  3/40; ...
                   -23820799268171657/33776997205278720,    -349665101050109/11258999068426240,        -262248825787583/8444249301319680, 96554709578623479656219464004587/57044277010270323067351644241920 - (1075138741208855*5^(1/2))/2251799813685248,     186770778921893122325591026842897/25353012004564588029934064107520 - (29476442240443305*5^(1/2))/9007199254740992, (58952884480886597*5^(1/2))/18014398509481984 - 3307738877085449311666527601885939/456354216082162584538813153935360,   (4300554964835411*5^(1/2))/9007199254740992 - 401389883063303890261072687680509/456354216082162584538813153935360,   (100703549102431661*5^(1/2))/18014398509481984 - 5736118966032745969268428671616961/456354216082162584538813153935360,      16788289526630603638390163712409/1267650600228229401496703205376 - (3146985909450989*5^(1/2))/562949953421312,   -9440957728352943/11258999068426240; ...
                  233929210383332597/810647932926689280,  25175887275607877/810647932926689280,     25175887275607787/810647932926689280, (1075138741208855*5^(1/2))/2251799813685248 - 24720981948584036058176588742787/12676506002282294014967032053760, (29476442240443305*5^(1/2))/9007199254740992 - 12216835028159212053954562055166137/1825416864328650338155252615741440,  666683025229150247022661877846677/101412048018258352119736256430080 - (58952884480886597*5^(1/2))/18014398509481984, 2075630226333363593458055119992341/1825416864328650338155252615741440 - (4300554964835411*5^(1/2))/9007199254740992, 44948810340101641688602836776294713/3650833728657300676310505231482880 - (100703549102431603*5^(1/2))/18014398509481984,  (50351774551215795*5^(1/2))/9007199254740992 - 179253717688523189016129283330139/14261069252567580766837911060480,   75527661826823631/90071992547409920; ...
                    -3752999689475413/90071992547409920,   -3752999689475413/90071992547409920,    -40421720052167227/135107988821114880,                                              31691265005705404966254516773033/456354216082162584538813153935360,                                                  -150825123804434581433644180565749/202824096036516704239472512860160,                                                3295891560593396074354603997026867/3650833728657300676310505231482880,                                               3728972708662403926977936044084567/3650833728657300676310505231482880,       830252090533346725797825097315369/730166745731460135262101046296576 - (4300554964835417*5^(1/2))/9007199254740992,    (4300554964835417*5^(1/2))/9007199254740992 - 26759325537553602031564420016209/30423614405477505635920876929024, -101330991615836151/90071992547409920; ...
                  -33776997205278707/810647932926689280, -33776997205278707/810647932926689280,    512746297955232973/810647932926689280,                                              42913204257165791220800275186109/228177108041081292269406576967680,                                                    63382530011411689657271339805757/912708432164325169077626307870720,                                                   81877303016981833117698490002113/912708432164325169077626307870720,                                               1098630520197798078149806693148009/1216944576219100225436835077160960,      266673210091660021966401521901813/40564819207303340847894502572032 - (58952884480886579*5^(1/2))/18014398509481984, (58952884480886579*5^(1/2))/18014398509481984 - 661547775417089467788189257820085/91270843216432516907762630787072, -101330991615836121/90071992547409920; ...
                  50351774551215731/1621295865853378560, 50351774551215731/1621295865853378560, -1042694815769807899/1621295865853378560,                                             -15845632502852699162951220745891/228177108041081292269406576967680,                                                 -686611268114656595311057330060247/3650833728657300676310505231482880,                                                 126765060022823587218244646226229/1825416864328650338155252615741440,                                               -904950742826606968866608814905039/1216944576219100225436835077160960,    (58952884480886599*5^(1/2))/18014398509481984 - 1085940891391929789621413707209229/162259276829213363391578010288128, 420234252574259335087470356017481/57044277010270323067351644241920 - (58952884480886599*5^(1/2))/18014398509481984, 151055323653647193/180143985094819840; ...
                    -1573492954725491/50665495807918080,   -1573492954725491/50665495807918080,        1434198717438413/6333186975989760,                                                 2356642559444288022726635540787/3169126500570573503741758013440,                                                     -3169126500570549942160311480109/45635421608216258453881315393536,                                                       476813380635175916930762988075/2535301200456458802993406410752,                                                    6338253001141119805425563754911/91270843216432516907762630787072,       (1075138741208853*5^(1/2))/2251799813685248 - 889955350149024312169489423723691/456354216082162584538813153935360,    96554709578623307098120986180089/57044277010270323067351644241920 - (1075138741208853*5^(1/2))/2251799813685248,    -4720478864176473/5629499534213120; ...
                                                   3/40,                                  3/40,                                     3/40,                                                                             -9440957728352943/11258999068426240,                                                                                   75527661826823631/90071992547409920,                                                                                -101330991615836151/90071992547409920,                                                                               -101330991615836121/90071992547409920,                                                                                   151055323653647193/180143985094819840,                                                                                 -4720478864176473/5629499534213120,                                 81/40];
    case 'B1'
        % Linear Lagrangian elements on triangle + cubic bubble
        DERXX = [ 19,  -1,   9, -27; ...
                  -1,  19,   9, -27; ...
                   9,   9,   9, -27; ...
                 -27, -27, -27,  81]/20;
        DERYY = [ 19,   9,  -1, -27; ...
                   9,   9,   9, -27; ...
                  -1,   9,  19, -27; ...
                 -27, -27, -27,  81]/20;
        DERXY =  [ 29,   9, -11, -27; ...
                  -11,   9,  29, -27; ...
                    9,   9,   9, -27; ...
                  -27, -27, -27,  81]/40;
    case 'Q1'
        % Linear Lagrangian elements on square
        DERXX = [  1/3, -1/3, -1/6,  1/6; ...
                  -1/3,  1/3,  1/6, -1/6; ...
                  -1/6,  1/6,  1/3, -1/3; ...
                   1/6, -1/6, -1/3,  1/3];
        DERYY = [  1/3,  1/6, -1/6, -1/3; ...
                   1/6,  1/3, -1/3, -1/6; ...
                  -1/6, -1/3,  1/3,  1/6; ...
                  -1/3, -1/6,  1/6,  1/3];
        DERXY = [  1/4,  1/4, -1/4, -1/4; ...
                  -1/4, -1/4,  1/4,  1/4; ...
                  -1/4, -1/4,  1/4,  1/4; ...
                   1/4,  1/4, -1/4, -1/4];
    case 'Q2'
        % Quadratic Lagrangian elements on square
        DERXX = [  14/45,   2/45,  -1/90,  -7/90, -16/45,   1/45,   4/45,   7/45,  -8/45; ...
                    2/45,  14/45,  -7/90,  -1/90, -16/45,   7/45,   4/45,   1/45,  -8/45; ...
                   -1/90,  -7/90,  14/45,   2/45,   4/45,   7/45, -16/45,   1/45,  -8/45; ...
                   -7/90,  -1/90,   2/45,  14/45,   4/45,   1/45, -16/45,   7/45,  -8/45; ...
                  -16/45, -16/45,   4/45,   4/45,  32/45,  -8/45,  -8/45,  -8/45,  16/45; ...
                    1/45,   7/45,   7/45,   1/45,  -8/45,  56/45,  -8/45,   8/45, -64/45; ...
                    4/45,   4/45, -16/45, -16/45,  -8/45,  -8/45,  32/45,  -8/45,  16/45; ...
                    7/45,   1/45,   1/45,   7/45,  -8/45,   8/45,  -8/45,  56/45, -64/45; ...
                   -8/45,  -8/45,  -8/45,  -8/45,  16/45, -64/45,  16/45, -64/45, 128/45];
        DERYY = [  14/45,  -7/90,  -1/90,   2/45,   7/45,   4/45,   1/45, -16/45,  -8/45; ...
                   -7/90,  14/45,   2/45,  -1/90,   7/45, -16/45,   1/45,   4/45,  -8/45; ...
                   -1/90,   2/45,  14/45,  -7/90,   1/45, -16/45,   7/45,   4/45,  -8/45; ...
                    2/45,  -1/90,  -7/90,  14/45,   1/45,   4/45,   7/45, -16/45,  -8/45; ...
                    7/45,   7/45,   1/45,   1/45,  56/45,  -8/45,   8/45,  -8/45, -64/45; ...
                    4/45, -16/45, -16/45,   4/45,  -8/45,  32/45,  -8/45,  -8/45,  16/45; ...
                    1/45,   1/45,   7/45,   7/45,   8/45,  -8/45,  56/45,  -8/45, -64/45; ...
                  -16/45,   4/45,   4/45, -16/45,  -8/45,  -8/45,  -8/45,  32/45,  16/45; ...
                   -8/45,  -8/45,  -8/45,  -8/45, -64/45,  16/45, -64/45,  16/45, 128/45];
        DERXY = [   1/4, -1/12, -1/36,  1/12,  1/3,  1/9,  1/9, -1/3, -4/9; ...
                   1/12,  -1/4, -1/12,  1/36, -1/3,  1/3, -1/9, -1/9,  4/9; ...
                  -1/36,  1/12,   1/4, -1/12,  1/9, -1/3,  1/3,  1/9, -4/9; ...
                  -1/12,  1/36,  1/12,  -1/4, -1/9, -1/9, -1/3,  1/3,  4/9; ...
                   -1/3,   1/3,   1/9,  -1/9,    0, -4/9,    0,  4/9,    0; ...
                    1/9,  -1/3,   1/3,  -1/9, -4/9,    0,  4/9,    0,    0; ...
                    1/9,  -1/9,  -1/3,   1/3,    0,  4/9,    0, -4/9,    0; ...
                    1/3,  -1/9,   1/9,  -1/3,  4/9,    0, -4/9,    0,    0; ...
                   -4/9,   4/9,  -4/9,   4/9,    0,    0,    0,    0,    0];
    case 'Q3'
        % Cubic Lagrangian elements on square
        DERXX = [    148/525,    -13/525, -247/67200,  703/16800,       -9/25,      18/175, -429/22400,    39/5600,   171/11200,   -171/3200,  -111/1400,  1221/5600,   -891/3200,   891/11200,    -81/2800,      81/800; ...
                     -13/525,    148/525,  703/16800, -247/67200,      18/175,       -9/25,  1221/5600,  -111/1400,   -171/3200,   171/11200,    39/5600, -429/22400,   891/11200,   -891/3200,      81/800,    -81/2800; ...
                  -247/67200,  703/16800,    148/525,    -13/525,   171/11200,   -171/3200,  -111/1400,  1221/5600,       -9/25,      18/175, -429/22400,    39/5600,    -81/2800,      81/800,   -891/3200,   891/11200; ...
                   703/16800, -247/67200,    -13/525,    148/525,   -171/3200,   171/11200,    39/5600, -429/22400,      18/175,       -9/25,  1221/5600,  -111/1400,      81/800,    -81/2800,   891/11200,   -891/3200; ...
                       -9/25,     18/175,  171/11200,  -171/3200,     144/175,     -99/175,  891/11200,   -81/2800, -1881/22400,    171/1400,     81/800,  -891/3200,    891/1400, -9801/22400,    891/5600,     -81/350; ...
                      18/175,      -9/25,  -171/3200,  171/11200,     -99/175,     144/175,  -891/3200,     81/800,    171/1400, -1881/22400,   -81/2800,  891/11200, -9801/22400,    891/1400,     -81/350,    891/5600; ...
                  -429/22400,  1221/5600,  -111/1400,    39/5600,   891/11200,   -891/3200,    999/700,  -999/5600,      81/800,    -81/2800,  351/22400,  -351/2800,    729/1400,    -729/400,    729/3200,  -729/11200; ...
                     39/5600,  -111/1400,  1221/5600, -429/22400,    -81/2800,      81/800,  -999/5600,    999/700,   -891/3200,   891/11200,  -351/2800,  351/22400,  -729/11200,    729/3200,    -729/400,    729/1400; ...
                   171/11200,  -171/3200,      -9/25,     18/175, -1881/22400,    171/1400,     81/800,  -891/3200,     144/175,     -99/175,  891/11200,   -81/2800,    891/5600,     -81/350,    891/1400, -9801/22400; ...
                   -171/3200,  171/11200,     18/175,      -9/25,    171/1400, -1881/22400,   -81/2800,  891/11200,     -99/175,     144/175,  -891/3200,     81/800,     -81/350,    891/5600, -9801/22400,    891/1400; ...
                   -111/1400,    39/5600, -429/22400,  1221/5600,      81/800,    -81/2800,  351/22400,  -351/2800,   891/11200,   -891/3200,    999/700,  -999/5600,    729/3200,  -729/11200,    729/1400,    -729/400; ...
                   1221/5600, -429/22400,    39/5600,  -111/1400,   -891/3200,   891/11200,  -351/2800,  351/22400,    -81/2800,      81/800,  -999/5600,    999/700,    -729/400,    729/1400,  -729/11200,    729/3200; ...
                   -891/3200,  891/11200,   -81/2800,     81/800,    891/1400, -9801/22400,   729/1400, -729/11200,    891/5600,     -81/350,   729/3200,   -729/400,     729/175,  -8019/2800,  8019/22400,   -729/1400; ...
                   891/11200,  -891/3200,     81/800,   -81/2800, -9801/22400,    891/1400,   -729/400,   729/3200,     -81/350,    891/5600, -729/11200,   729/1400,  -8019/2800,     729/175,   -729/1400,  8019/22400; ...
                    -81/2800,     81/800,  -891/3200,  891/11200,    891/5600,     -81/350,   729/3200,   -729/400,    891/1400, -9801/22400,   729/1400, -729/11200,  8019/22400,   -729/1400,     729/175,  -8019/2800; ...
                      81/800,   -81/2800,  891/11200,  -891/3200,     -81/350,    891/5600, -729/11200,   729/1400, -9801/22400,    891/1400,   -729/400,   729/3200,   -729/1400,  8019/22400,  -8019/2800,     729/175];
        DERYY = [    148/525,  703/16800, -247/67200,    -13/525,  1221/5600,  -111/1400,   -171/3200,   171/11200,    39/5600, -429/22400,      18/175,       -9/25,   -891/3200,      81/800,    -81/2800,   891/11200; ...
                   703/16800,    148/525,    -13/525, -247/67200,  -111/1400,  1221/5600,       -9/25,      18/175, -429/22400,    39/5600,   171/11200,   -171/3200,      81/800,   -891/3200,   891/11200,    -81/2800; ...
                  -247/67200,    -13/525,    148/525,  703/16800,    39/5600, -429/22400,      18/175,       -9/25,  1221/5600,  -111/1400,   -171/3200,   171/11200,    -81/2800,   891/11200,   -891/3200,      81/800; ...
                     -13/525, -247/67200,  703/16800,    148/525, -429/22400,    39/5600,   171/11200,   -171/3200,  -111/1400,  1221/5600,       -9/25,      18/175,   891/11200,    -81/2800,      81/800,   -891/3200; ...
                   1221/5600,  -111/1400,    39/5600, -429/22400,    999/700,  -999/5600,      81/800,    -81/2800,  351/22400,  -351/2800,   891/11200,   -891/3200,    -729/400,    729/3200,  -729/11200,    729/1400; ...
                   -111/1400,  1221/5600, -429/22400,    39/5600,  -999/5600,    999/700,   -891/3200,   891/11200,  -351/2800,  351/22400,    -81/2800,      81/800,    729/3200,    -729/400,    729/1400,  -729/11200; ...
                   -171/3200,      -9/25,     18/175,  171/11200,     81/800,  -891/3200,     144/175,     -99/175,  891/11200,   -81/2800, -1881/22400,    171/1400,     -81/350,    891/1400, -9801/22400,    891/5600; ...
                   171/11200,     18/175,      -9/25,  -171/3200,   -81/2800,  891/11200,     -99/175,     144/175,  -891/3200,     81/800,    171/1400, -1881/22400,    891/5600, -9801/22400,    891/1400,     -81/350; ...
                     39/5600, -429/22400,  1221/5600,  -111/1400,  351/22400,  -351/2800,   891/11200,   -891/3200,    999/700,  -999/5600,      81/800,    -81/2800,  -729/11200,    729/1400,    -729/400,    729/3200; ...
                  -429/22400,    39/5600,  -111/1400,  1221/5600,  -351/2800,  351/22400,    -81/2800,      81/800,  -999/5600,    999/700,   -891/3200,   891/11200,    729/1400,  -729/11200,    729/3200,    -729/400; ...
                      18/175,  171/11200,  -171/3200,      -9/25,  891/11200,   -81/2800, -1881/22400,    171/1400,     81/800,  -891/3200,     144/175,     -99/175, -9801/22400,    891/5600,     -81/350,    891/1400; ...
                       -9/25,  -171/3200,  171/11200,     18/175,  -891/3200,     81/800,    171/1400, -1881/22400,   -81/2800,  891/11200,     -99/175,     144/175,    891/1400,     -81/350,    891/5600, -9801/22400; ...
                   -891/3200,     81/800,   -81/2800,  891/11200,   -729/400,   729/3200,     -81/350,    891/5600, -729/11200,   729/1400, -9801/22400,    891/1400,     729/175,   -729/1400,  8019/22400,  -8019/2800; ...
                      81/800,  -891/3200,  891/11200,   -81/2800,   729/3200,   -729/400,    891/1400, -9801/22400,   729/1400, -729/11200,    891/5600,     -81/350,   -729/1400,     729/175,  -8019/2800,  8019/22400; ...
                    -81/2800,  891/11200,  -891/3200,     81/800, -729/11200,   729/1400, -9801/22400,    891/1400,   -729/400,   729/3200,     -81/350,    891/5600,  8019/22400,  -8019/2800,     729/175,   -729/1400; ...
                   891/11200,   -81/2800,     81/800,  -891/3200,   729/1400, -729/11200,    891/5600,     -81/350,   729/3200,   -729/400,    891/1400, -9801/22400,  -8019/2800,  8019/22400,   -729/1400,     729/175];
        DERXY = [        1/4,     7/160,   -49/6400,    -7/160,     57/160,      -3/20,  -399/6400,     21/800,     21/800,  -399/6400,       3/20,    -57/160, -3249/6400,    171/800,     -9/100,    171/800; ...
                      -7/160,      -1/4,      7/160,   49/6400,       3/20,    -57/160,     57/160,      -3/20,   399/6400,    -21/800,    -21/800,   399/6400,   -171/800,  3249/6400,   -171/800,      9/100; ...
                    -49/6400,    -7/160,        1/4,     7/160,     21/800,  -399/6400,       3/20,    -57/160,     57/160,      -3/20,  -399/6400,     21/800,     -9/100,    171/800, -3249/6400,    171/800; ...
                       7/160,   49/6400,     -7/160,      -1/4,   399/6400,    -21/800,    -21/800,   399/6400,       3/20,    -57/160,     57/160,      -3/20,   -171/800,      9/100,   -171/800,  3249/6400; ...
                     -57/160,     -3/20,     21/800,  399/6400,          0,     81/160,    171/800,     -9/100,  -567/6400,          0,   -171/800,  3249/6400,          0, -4617/6400,    243/800,          0; ...
                        3/20,    57/160,  -399/6400,   -21/800,    -81/160,          0, -3249/6400,    171/800,          0,   567/6400,      9/100,   -171/800,  4617/6400,          0,          0,   -243/800; ...
                   -399/6400,   -57/160,      -3/20,   -21/800,    171/800, -3249/6400,          0,     81/160,   -171/800,      9/100,   567/6400,          0,          0,          0,  4617/6400,   -243/800; ...
                      21/800,      3/20,     57/160,  399/6400,     -9/100,    171/800,    -81/160,          0,  3249/6400,   -171/800,          0,  -567/6400,    243/800, -4617/6400,          0,          0; ...
                      21/800,  399/6400,    -57/160,     -3/20,  -567/6400,          0,   -171/800,  3249/6400,          0,     81/160,    171/800,     -9/100,    243/800,          0,          0, -4617/6400; ...
                   -399/6400,   -21/800,       3/20,    57/160,          0,   567/6400,      9/100,   -171/800,    -81/160,          0, -3249/6400,    171/800,          0,   -243/800,  4617/6400,          0; ...
                       -3/20,   -21/800,  -399/6400,   -57/160,   -171/800,      9/100,   567/6400,          0,    171/800, -3249/6400,          0,     81/160,  4617/6400,   -243/800,          0,          0; ...
                      57/160,  399/6400,     21/800,      3/20,  3249/6400,   -171/800,          0,  -567/6400,     -9/100,    171/800,    -81/160,          0,          0,          0,    243/800, -4617/6400; ...
                  -3249/6400,  -171/800,     -9/100,  -171/800,          0,  4617/6400,          0,    243/800,    243/800,          0,  4617/6400,          0,          0,          0, -6561/6400,          0; ...
                     171/800, 3249/6400,    171/800,     9/100, -4617/6400,          0,          0, -4617/6400,          0,   -243/800,   -243/800,          0,          0,          0,          0,  6561/6400; ...
                      -9/100,  -171/800, -3249/6400,  -171/800,    243/800,          0,  4617/6400,          0,          0,  4617/6400,          0,    243/800, -6561/6400,          0,          0,          0; ...
                     171/800,     9/100,    171/800, 3249/6400,          0,   -243/800,   -243/800,          0, -4617/6400,          0,          0, -4617/6400,          0,  6561/6400,          0,          0];
    case 'Q3gl'
        % Cubic Lagrangian elements on square with Gauss-Lobatto nodes
        DERXX = [                        13/42,                        -1/84,                       -1/504,                       13/252,    - (5*5^(1/2))/56 - 25/168,      (5*5^(1/2))/56 - 25/168,                  -5^(1/2)/504,                   5^(1/2)/504,    (5*5^(1/2))/336 - 25/1008,  - (5*5^(1/2))/336 - 25/1008,             -(13*5^(1/2))/252,              (13*5^(1/2))/252,  - (25*5^(1/2))/1008 - 25/336,    25/336 - (25*5^(1/2))/1008,    (25*5^(1/2))/1008 - 25/336,    (25*5^(1/2))/1008 + 25/336; ...
                                         -1/84,                        13/42,                       13/252,                       -1/504,      (5*5^(1/2))/56 - 25/168,    - (5*5^(1/2))/56 - 25/168,              (13*5^(1/2))/252,             -(13*5^(1/2))/252,  - (5*5^(1/2))/336 - 25/1008,    (5*5^(1/2))/336 - 25/1008,                   5^(1/2)/504,                  -5^(1/2)/504,    25/336 - (25*5^(1/2))/1008,  - (25*5^(1/2))/1008 - 25/336,    (25*5^(1/2))/1008 + 25/336,    (25*5^(1/2))/1008 - 25/336; ...
                                        -1/504,                       13/252,                        13/42,                        -1/84,    (5*5^(1/2))/336 - 25/1008,  - (5*5^(1/2))/336 - 25/1008,             -(13*5^(1/2))/252,              (13*5^(1/2))/252,    - (5*5^(1/2))/56 - 25/168,      (5*5^(1/2))/56 - 25/168,                  -5^(1/2)/504,                   5^(1/2)/504,    (25*5^(1/2))/1008 - 25/336,    (25*5^(1/2))/1008 + 25/336,  - (25*5^(1/2))/1008 - 25/336,    25/336 - (25*5^(1/2))/1008; ...
                                        13/252,                       -1/504,                        -1/84,                        13/42,  - (5*5^(1/2))/336 - 25/1008,    (5*5^(1/2))/336 - 25/1008,                   5^(1/2)/504,                  -5^(1/2)/504,      (5*5^(1/2))/56 - 25/168,    - (5*5^(1/2))/56 - 25/168,              (13*5^(1/2))/252,             -(13*5^(1/2))/252,    (25*5^(1/2))/1008 + 25/336,    (25*5^(1/2))/1008 - 25/336,    25/336 - (25*5^(1/2))/1008,  - (25*5^(1/2))/1008 - 25/336; ...
                     - (5*5^(1/2))/56 - 25/168,      (5*5^(1/2))/56 - 25/168,    (5*5^(1/2))/336 - 25/1008,  - (5*5^(1/2))/336 - 25/1008,                        25/42,                       -25/84,    25/336 - (25*5^(1/2))/1008,    (25*5^(1/2))/1008 - 25/336,                      -25/504,                       25/252,    (25*5^(1/2))/1008 + 25/336,  - (25*5^(1/2))/1008 - 25/336,              (25*5^(1/2))/252,             -(25*5^(1/2))/504,              (25*5^(1/2))/504,             -(25*5^(1/2))/252; ...
                       (5*5^(1/2))/56 - 25/168,    - (5*5^(1/2))/56 - 25/168,  - (5*5^(1/2))/336 - 25/1008,    (5*5^(1/2))/336 - 25/1008,                       -25/84,                        25/42,  - (25*5^(1/2))/1008 - 25/336,    (25*5^(1/2))/1008 + 25/336,                       25/252,                      -25/504,    (25*5^(1/2))/1008 - 25/336,    25/336 - (25*5^(1/2))/1008,             -(25*5^(1/2))/504,              (25*5^(1/2))/252,             -(25*5^(1/2))/252,              (25*5^(1/2))/504; ...
                                  -5^(1/2)/504,             (13*5^(1/2))/252,            -(13*5^(1/2))/252,                  5^(1/2)/504,   25/336 - (25*5^(1/2))/1008, - (25*5^(1/2))/1008 - 25/336,                         65/42,                        65/252,   (25*5^(1/2))/1008 + 25/336,   (25*5^(1/2))/1008 - 25/336,                        -5/504,                         -5/84,     (25*5^(1/2))/56 - 125/168,   - (25*5^(1/2))/56 - 125/168, - (25*5^(1/2))/336 - 125/1008,   (25*5^(1/2))/336 - 125/1008; ...
                                   5^(1/2)/504,            -(13*5^(1/2))/252,             (13*5^(1/2))/252,                 -5^(1/2)/504,   (25*5^(1/2))/1008 - 25/336,   (25*5^(1/2))/1008 + 25/336,                        65/252,                         65/42, - (25*5^(1/2))/1008 - 25/336,   25/336 - (25*5^(1/2))/1008,                         -5/84,                        -5/504,   (25*5^(1/2))/336 - 125/1008, - (25*5^(1/2))/336 - 125/1008,   - (25*5^(1/2))/56 - 125/168,     (25*5^(1/2))/56 - 125/168; ...
                     (5*5^(1/2))/336 - 25/1008,  - (5*5^(1/2))/336 - 25/1008,    - (5*5^(1/2))/56 - 25/168,      (5*5^(1/2))/56 - 25/168,                      -25/504,                       25/252,    (25*5^(1/2))/1008 + 25/336,  - (25*5^(1/2))/1008 - 25/336,                        25/42,                       -25/84,    25/336 - (25*5^(1/2))/1008,    (25*5^(1/2))/1008 - 25/336,              (25*5^(1/2))/504,             -(25*5^(1/2))/252,              (25*5^(1/2))/252,             -(25*5^(1/2))/504; ...
                   - (5*5^(1/2))/336 - 25/1008,    (5*5^(1/2))/336 - 25/1008,      (5*5^(1/2))/56 - 25/168,    - (5*5^(1/2))/56 - 25/168,                       25/252,                      -25/504,    (25*5^(1/2))/1008 - 25/336,    25/336 - (25*5^(1/2))/1008,                       -25/84,                        25/42,  - (25*5^(1/2))/1008 - 25/336,    (25*5^(1/2))/1008 + 25/336,             -(25*5^(1/2))/252,              (25*5^(1/2))/504,             -(25*5^(1/2))/504,              (25*5^(1/2))/252; ...
                             -(13*5^(1/2))/252,                  5^(1/2)/504,                 -5^(1/2)/504,             (13*5^(1/2))/252,   (25*5^(1/2))/1008 + 25/336,   (25*5^(1/2))/1008 - 25/336,                        -5/504,                         -5/84,   25/336 - (25*5^(1/2))/1008, - (25*5^(1/2))/1008 - 25/336,                         65/42,                        65/252, - (25*5^(1/2))/336 - 125/1008,   (25*5^(1/2))/336 - 125/1008,     (25*5^(1/2))/56 - 125/168,   - (25*5^(1/2))/56 - 125/168; ...
                              (13*5^(1/2))/252,                 -5^(1/2)/504,                  5^(1/2)/504,            -(13*5^(1/2))/252, - (25*5^(1/2))/1008 - 25/336,   25/336 - (25*5^(1/2))/1008,                         -5/84,                        -5/504,   (25*5^(1/2))/1008 - 25/336,   (25*5^(1/2))/1008 + 25/336,                        65/252,                         65/42,   - (25*5^(1/2))/56 - 125/168,     (25*5^(1/2))/56 - 125/168,   (25*5^(1/2))/336 - 125/1008, - (25*5^(1/2))/336 - 125/1008; ...
                  - (25*5^(1/2))/1008 - 25/336,   25/336 - (25*5^(1/2))/1008,   (25*5^(1/2))/1008 - 25/336,   (25*5^(1/2))/1008 + 25/336,             (25*5^(1/2))/252,            -(25*5^(1/2))/504,     (25*5^(1/2))/56 - 125/168,   (25*5^(1/2))/336 - 125/1008,             (25*5^(1/2))/504,            -(25*5^(1/2))/252, - (25*5^(1/2))/336 - 125/1008,   - (25*5^(1/2))/56 - 125/168,                        125/42,                       -125/84,                      -125/504,                       125/252; ...
                    25/336 - (25*5^(1/2))/1008, - (25*5^(1/2))/1008 - 25/336,   (25*5^(1/2))/1008 + 25/336,   (25*5^(1/2))/1008 - 25/336,            -(25*5^(1/2))/504,             (25*5^(1/2))/252,   - (25*5^(1/2))/56 - 125/168, - (25*5^(1/2))/336 - 125/1008,            -(25*5^(1/2))/252,             (25*5^(1/2))/504,   (25*5^(1/2))/336 - 125/1008,     (25*5^(1/2))/56 - 125/168,                       -125/84,                        125/42,                       125/252,                      -125/504; ...
                    (25*5^(1/2))/1008 - 25/336,   (25*5^(1/2))/1008 + 25/336, - (25*5^(1/2))/1008 - 25/336,   25/336 - (25*5^(1/2))/1008,             (25*5^(1/2))/504,            -(25*5^(1/2))/252, - (25*5^(1/2))/336 - 125/1008,   - (25*5^(1/2))/56 - 125/168,             (25*5^(1/2))/252,            -(25*5^(1/2))/504,     (25*5^(1/2))/56 - 125/168,   (25*5^(1/2))/336 - 125/1008,                      -125/504,                       125/252,                        125/42,                       -125/84; ...
                    (25*5^(1/2))/1008 + 25/336,   (25*5^(1/2))/1008 - 25/336,   25/336 - (25*5^(1/2))/1008, - (25*5^(1/2))/1008 - 25/336,            -(25*5^(1/2))/252,             (25*5^(1/2))/504,   (25*5^(1/2))/336 - 125/1008,     (25*5^(1/2))/56 - 125/168,            -(25*5^(1/2))/504,             (25*5^(1/2))/252,   - (25*5^(1/2))/56 - 125/168, - (25*5^(1/2))/336 - 125/1008,                       125/252,                      -125/504,                       -125/84,                        125/42];
        DERYY = [                        13/42,                       13/252,                       -1/504,                        -1/84,              (13*5^(1/2))/252,             -(13*5^(1/2))/252,  - (5*5^(1/2))/336 - 25/1008,    (5*5^(1/2))/336 - 25/1008,                   5^(1/2)/504,                  -5^(1/2)/504,      (5*5^(1/2))/56 - 25/168,    - (5*5^(1/2))/56 - 25/168,  - (25*5^(1/2))/1008 - 25/336,    (25*5^(1/2))/1008 + 25/336,    (25*5^(1/2))/1008 - 25/336,    25/336 - (25*5^(1/2))/1008; ...
                                        13/252,                        13/42,                        -1/84,                       -1/504,             -(13*5^(1/2))/252,              (13*5^(1/2))/252,    - (5*5^(1/2))/56 - 25/168,      (5*5^(1/2))/56 - 25/168,                  -5^(1/2)/504,                   5^(1/2)/504,    (5*5^(1/2))/336 - 25/1008,  - (5*5^(1/2))/336 - 25/1008,    (25*5^(1/2))/1008 + 25/336,  - (25*5^(1/2))/1008 - 25/336,    25/336 - (25*5^(1/2))/1008,    (25*5^(1/2))/1008 - 25/336; ...
                                        -1/504,                        -1/84,                        13/42,                       13/252,                   5^(1/2)/504,                  -5^(1/2)/504,      (5*5^(1/2))/56 - 25/168,    - (5*5^(1/2))/56 - 25/168,              (13*5^(1/2))/252,             -(13*5^(1/2))/252,  - (5*5^(1/2))/336 - 25/1008,    (5*5^(1/2))/336 - 25/1008,    (25*5^(1/2))/1008 - 25/336,    25/336 - (25*5^(1/2))/1008,  - (25*5^(1/2))/1008 - 25/336,    (25*5^(1/2))/1008 + 25/336; ...
                                         -1/84,                       -1/504,                       13/252,                        13/42,                  -5^(1/2)/504,                   5^(1/2)/504,    (5*5^(1/2))/336 - 25/1008,  - (5*5^(1/2))/336 - 25/1008,             -(13*5^(1/2))/252,              (13*5^(1/2))/252,    - (5*5^(1/2))/56 - 25/168,      (5*5^(1/2))/56 - 25/168,    25/336 - (25*5^(1/2))/1008,    (25*5^(1/2))/1008 - 25/336,    (25*5^(1/2))/1008 + 25/336,  - (25*5^(1/2))/1008 - 25/336; ...
                              (13*5^(1/2))/252,            -(13*5^(1/2))/252,                  5^(1/2)/504,                 -5^(1/2)/504,                         65/42,                        65/252,   (25*5^(1/2))/1008 + 25/336,   (25*5^(1/2))/1008 - 25/336,                        -5/504,                         -5/84,   25/336 - (25*5^(1/2))/1008, - (25*5^(1/2))/1008 - 25/336,   - (25*5^(1/2))/56 - 125/168, - (25*5^(1/2))/336 - 125/1008,   (25*5^(1/2))/336 - 125/1008,     (25*5^(1/2))/56 - 125/168; ...
                             -(13*5^(1/2))/252,             (13*5^(1/2))/252,                 -5^(1/2)/504,                  5^(1/2)/504,                        65/252,                         65/42, - (25*5^(1/2))/1008 - 25/336,   25/336 - (25*5^(1/2))/1008,                         -5/84,                        -5/504,   (25*5^(1/2))/1008 - 25/336,   (25*5^(1/2))/1008 + 25/336, - (25*5^(1/2))/336 - 125/1008,   - (25*5^(1/2))/56 - 125/168,     (25*5^(1/2))/56 - 125/168,   (25*5^(1/2))/336 - 125/1008; ...
                   - (5*5^(1/2))/336 - 25/1008,    - (5*5^(1/2))/56 - 25/168,      (5*5^(1/2))/56 - 25/168,    (5*5^(1/2))/336 - 25/1008,    (25*5^(1/2))/1008 + 25/336,  - (25*5^(1/2))/1008 - 25/336,                        25/42,                       -25/84,    25/336 - (25*5^(1/2))/1008,    (25*5^(1/2))/1008 - 25/336,                      -25/504,                       25/252,             -(25*5^(1/2))/252,              (25*5^(1/2))/252,             -(25*5^(1/2))/504,              (25*5^(1/2))/504; ...
                     (5*5^(1/2))/336 - 25/1008,      (5*5^(1/2))/56 - 25/168,    - (5*5^(1/2))/56 - 25/168,  - (5*5^(1/2))/336 - 25/1008,    (25*5^(1/2))/1008 - 25/336,    25/336 - (25*5^(1/2))/1008,                       -25/84,                        25/42,  - (25*5^(1/2))/1008 - 25/336,    (25*5^(1/2))/1008 + 25/336,                       25/252,                      -25/504,              (25*5^(1/2))/504,             -(25*5^(1/2))/504,              (25*5^(1/2))/252,             -(25*5^(1/2))/252; ...
                                   5^(1/2)/504,                 -5^(1/2)/504,             (13*5^(1/2))/252,            -(13*5^(1/2))/252,                        -5/504,                         -5/84,   25/336 - (25*5^(1/2))/1008, - (25*5^(1/2))/1008 - 25/336,                         65/42,                        65/252,   (25*5^(1/2))/1008 + 25/336,   (25*5^(1/2))/1008 - 25/336,   (25*5^(1/2))/336 - 125/1008,     (25*5^(1/2))/56 - 125/168,   - (25*5^(1/2))/56 - 125/168, - (25*5^(1/2))/336 - 125/1008; ...
                                  -5^(1/2)/504,                  5^(1/2)/504,            -(13*5^(1/2))/252,             (13*5^(1/2))/252,                         -5/84,                        -5/504,   (25*5^(1/2))/1008 - 25/336,   (25*5^(1/2))/1008 + 25/336,                        65/252,                         65/42, - (25*5^(1/2))/1008 - 25/336,   25/336 - (25*5^(1/2))/1008,     (25*5^(1/2))/56 - 125/168,   (25*5^(1/2))/336 - 125/1008, - (25*5^(1/2))/336 - 125/1008,   - (25*5^(1/2))/56 - 125/168; ...
                       (5*5^(1/2))/56 - 25/168,    (5*5^(1/2))/336 - 25/1008,  - (5*5^(1/2))/336 - 25/1008,    - (5*5^(1/2))/56 - 25/168,    25/336 - (25*5^(1/2))/1008,    (25*5^(1/2))/1008 - 25/336,                      -25/504,                       25/252,    (25*5^(1/2))/1008 + 25/336,  - (25*5^(1/2))/1008 - 25/336,                        25/42,                       -25/84,             -(25*5^(1/2))/504,              (25*5^(1/2))/504,             -(25*5^(1/2))/252,              (25*5^(1/2))/252; ...
                     - (5*5^(1/2))/56 - 25/168,  - (5*5^(1/2))/336 - 25/1008,    (5*5^(1/2))/336 - 25/1008,      (5*5^(1/2))/56 - 25/168,  - (25*5^(1/2))/1008 - 25/336,    (25*5^(1/2))/1008 + 25/336,                       25/252,                      -25/504,    (25*5^(1/2))/1008 - 25/336,    25/336 - (25*5^(1/2))/1008,                       -25/84,                        25/42,              (25*5^(1/2))/252,             -(25*5^(1/2))/252,              (25*5^(1/2))/504,             -(25*5^(1/2))/504; ...
                  - (25*5^(1/2))/1008 - 25/336,   (25*5^(1/2))/1008 + 25/336,   (25*5^(1/2))/1008 - 25/336,   25/336 - (25*5^(1/2))/1008,   - (25*5^(1/2))/56 - 125/168, - (25*5^(1/2))/336 - 125/1008,            -(25*5^(1/2))/252,             (25*5^(1/2))/504,   (25*5^(1/2))/336 - 125/1008,     (25*5^(1/2))/56 - 125/168,            -(25*5^(1/2))/504,             (25*5^(1/2))/252,                        125/42,                       125/252,                      -125/504,                       -125/84; ...
                    (25*5^(1/2))/1008 + 25/336, - (25*5^(1/2))/1008 - 25/336,   25/336 - (25*5^(1/2))/1008,   (25*5^(1/2))/1008 - 25/336, - (25*5^(1/2))/336 - 125/1008,   - (25*5^(1/2))/56 - 125/168,             (25*5^(1/2))/252,            -(25*5^(1/2))/504,     (25*5^(1/2))/56 - 125/168,   (25*5^(1/2))/336 - 125/1008,             (25*5^(1/2))/504,            -(25*5^(1/2))/252,                       125/252,                        125/42,                       -125/84,                      -125/504; ...
                    (25*5^(1/2))/1008 - 25/336,   25/336 - (25*5^(1/2))/1008, - (25*5^(1/2))/1008 - 25/336,   (25*5^(1/2))/1008 + 25/336,   (25*5^(1/2))/336 - 125/1008,     (25*5^(1/2))/56 - 125/168,            -(25*5^(1/2))/504,             (25*5^(1/2))/252,   - (25*5^(1/2))/56 - 125/168, - (25*5^(1/2))/336 - 125/1008,            -(25*5^(1/2))/252,             (25*5^(1/2))/504,                      -125/504,                       -125/84,                        125/42,                       125/252; ...
                    25/336 - (25*5^(1/2))/1008,   (25*5^(1/2))/1008 - 25/336,   (25*5^(1/2))/1008 + 25/336, - (25*5^(1/2))/1008 - 25/336,     (25*5^(1/2))/56 - 125/168,   (25*5^(1/2))/336 - 125/1008,             (25*5^(1/2))/504,            -(25*5^(1/2))/252, - (25*5^(1/2))/336 - 125/1008,   - (25*5^(1/2))/56 - 125/168,             (25*5^(1/2))/252,            -(25*5^(1/2))/504,                       -125/84,                      -125/504,                       125/252,                        125/42];
        DERXY = [                        1/4,                     1/24,                     -1/144,                    -1/24,        (5*5^(1/2))/48 + 5/48,      5/48 - (5*5^(1/2))/48,  - (5*5^(1/2))/288 - 5/288,      (5*5^(1/2))/288 - 5/288,      (5*5^(1/2))/288 - 5/288,  - (5*5^(1/2))/288 - 5/288,      (5*5^(1/2))/48 - 5/48,      - (5*5^(1/2))/48 - 5/48, - (25*5^(1/2))/288 - 25/96,                       25/144,   (25*5^(1/2))/288 - 25/96,                       25/144; ...
                                       -1/24,                     -1/4,                       1/24,                    1/144,        (5*5^(1/2))/48 - 5/48,    - (5*5^(1/2))/48 - 5/48,      (5*5^(1/2))/48 + 5/48,        5/48 - (5*5^(1/2))/48,      (5*5^(1/2))/288 + 5/288,    5/288 - (5*5^(1/2))/288,    5/288 - (5*5^(1/2))/288,      (5*5^(1/2))/288 + 5/288,                    -25/144,     (25*5^(1/2))/288 + 25/96,                    -25/144,     25/96 - (25*5^(1/2))/288; ...
                                      -1/144,                    -1/24,                        1/4,                     1/24,      (5*5^(1/2))/288 - 5/288,  - (5*5^(1/2))/288 - 5/288,      (5*5^(1/2))/48 - 5/48,      - (5*5^(1/2))/48 - 5/48,        (5*5^(1/2))/48 + 5/48,      5/48 - (5*5^(1/2))/48,  - (5*5^(1/2))/288 - 5/288,      (5*5^(1/2))/288 - 5/288,   (25*5^(1/2))/288 - 25/96,                       25/144, - (25*5^(1/2))/288 - 25/96,                       25/144; ...
                                        1/24,                    1/144,                      -1/24,                     -1/4,      (5*5^(1/2))/288 + 5/288,    5/288 - (5*5^(1/2))/288,    5/288 - (5*5^(1/2))/288,      (5*5^(1/2))/288 + 5/288,        (5*5^(1/2))/48 - 5/48,    - (5*5^(1/2))/48 - 5/48,      (5*5^(1/2))/48 + 5/48,        5/48 - (5*5^(1/2))/48,                    -25/144,     25/96 - (25*5^(1/2))/288,                    -25/144,     (25*5^(1/2))/288 + 25/96; ...
                     - (5*5^(1/2))/48 - 5/48,    5/48 - (5*5^(1/2))/48,    (5*5^(1/2))/288 - 5/288,  (5*5^(1/2))/288 + 5/288,                            0,             (5*5^(1/2))/24,                     25/144,     (25*5^(1/2))/288 - 25/96,             -(5*5^(1/2))/144,                          0,                    -25/144,     (25*5^(1/2))/288 + 25/96,                          0, - (25*5^(1/2))/288 - 125/288, 125/288 - (25*5^(1/2))/288,                            0; ...
                       (5*5^(1/2))/48 - 5/48,    (5*5^(1/2))/48 + 5/48,  - (5*5^(1/2))/288 - 5/288,  5/288 - (5*5^(1/2))/288,              -(5*5^(1/2))/24,                          0, - (25*5^(1/2))/288 - 25/96,                       25/144,                            0,            (5*5^(1/2))/144,   25/96 - (25*5^(1/2))/288,                      -25/144, (25*5^(1/2))/288 + 125/288,                            0,                          0,   (25*5^(1/2))/288 - 125/288; ...
                   - (5*5^(1/2))/288 - 5/288,  - (5*5^(1/2))/48 - 5/48,      5/48 - (5*5^(1/2))/48,  5/288 - (5*5^(1/2))/288,                       25/144, - (25*5^(1/2))/288 - 25/96,                          0,               (5*5^(1/2))/24,                      -25/144,   25/96 - (25*5^(1/2))/288,            (5*5^(1/2))/144,                            0,                          0,                            0, (25*5^(1/2))/288 + 125/288,   (25*5^(1/2))/288 - 125/288; ...
                     (5*5^(1/2))/288 - 5/288,    (5*5^(1/2))/48 - 5/48,      (5*5^(1/2))/48 + 5/48,  (5*5^(1/2))/288 + 5/288,     (25*5^(1/2))/288 - 25/96,                     25/144,            -(5*5^(1/2))/24,                            0,     (25*5^(1/2))/288 + 25/96,                    -25/144,                          0,             -(5*5^(1/2))/144, 125/288 - (25*5^(1/2))/288, - (25*5^(1/2))/288 - 125/288,                          0,                            0; ...
                     (5*5^(1/2))/288 - 5/288,  (5*5^(1/2))/288 + 5/288,    - (5*5^(1/2))/48 - 5/48,    5/48 - (5*5^(1/2))/48,             -(5*5^(1/2))/144,                          0,                    -25/144,     (25*5^(1/2))/288 + 25/96,                            0,             (5*5^(1/2))/24,                     25/144,     (25*5^(1/2))/288 - 25/96, 125/288 - (25*5^(1/2))/288,                            0,                          0, - (25*5^(1/2))/288 - 125/288; ...
                   - (5*5^(1/2))/288 - 5/288,  5/288 - (5*5^(1/2))/288,      (5*5^(1/2))/48 - 5/48,    (5*5^(1/2))/48 + 5/48,                            0,            (5*5^(1/2))/144,   25/96 - (25*5^(1/2))/288,                      -25/144,              -(5*5^(1/2))/24,                          0, - (25*5^(1/2))/288 - 25/96,                       25/144,                          0,   (25*5^(1/2))/288 - 125/288, (25*5^(1/2))/288 + 125/288,                            0; ...
                       5/48 - (5*5^(1/2))/48,  5/288 - (5*5^(1/2))/288,  - (5*5^(1/2))/288 - 5/288,  - (5*5^(1/2))/48 - 5/48,                      -25/144,   25/96 - (25*5^(1/2))/288,            (5*5^(1/2))/144,                            0,                       25/144, - (25*5^(1/2))/288 - 25/96,                          0,               (5*5^(1/2))/24, (25*5^(1/2))/288 + 125/288,   (25*5^(1/2))/288 - 125/288,                          0,                            0; ...
                       (5*5^(1/2))/48 + 5/48,  (5*5^(1/2))/288 + 5/288,    (5*5^(1/2))/288 - 5/288,    (5*5^(1/2))/48 - 5/48,     (25*5^(1/2))/288 + 25/96,                    -25/144,                          0,             -(5*5^(1/2))/144,     (25*5^(1/2))/288 - 25/96,                     25/144,            -(5*5^(1/2))/24,                            0,                          0,                            0, 125/288 - (25*5^(1/2))/288, - (25*5^(1/2))/288 - 125/288; ...
                  - (25*5^(1/2))/288 - 25/96,                  -25/144,   (25*5^(1/2))/288 - 25/96,                  -25/144,                            0, (25*5^(1/2))/288 + 125/288,                          0,   125/288 - (25*5^(1/2))/288,   125/288 - (25*5^(1/2))/288,                          0, (25*5^(1/2))/288 + 125/288,                            0,                          0,                            0,                   -125/144,                            0; ...
                                      25/144, (25*5^(1/2))/288 + 25/96,                     25/144, 25/96 - (25*5^(1/2))/288, - (25*5^(1/2))/288 - 125/288,                          0,                          0, - (25*5^(1/2))/288 - 125/288,                            0, (25*5^(1/2))/288 - 125/288, (25*5^(1/2))/288 - 125/288,                            0,                          0,                            0,                          0,                      125/144; ...
                    (25*5^(1/2))/288 - 25/96,                  -25/144, - (25*5^(1/2))/288 - 25/96,                  -25/144,   125/288 - (25*5^(1/2))/288,                          0, (25*5^(1/2))/288 + 125/288,                            0,                            0, (25*5^(1/2))/288 + 125/288,                          0,   125/288 - (25*5^(1/2))/288,                   -125/144,                            0,                          0,                            0; ...
                                      25/144, 25/96 - (25*5^(1/2))/288,                     25/144, (25*5^(1/2))/288 + 25/96,                            0, (25*5^(1/2))/288 - 125/288, (25*5^(1/2))/288 - 125/288,                            0, - (25*5^(1/2))/288 - 125/288,                          0,                          0, - (25*5^(1/2))/288 - 125/288,                          0,                      125/144,                          0,                            0];
end

switch flag
    case {1,3}
        % Standard stiffness matrix
        DERXY = DERXY+DERXY';
        gradgrad = [DERXX(:)'; DERYY(:)'; DERXY(:)'];
    case 2
        % Complete Stokes tensor
        DERYX = DERXY';
        gradgrad = [DERXX(:)'; DERYX(:)'; DERXY(:)'; DERYY(:)'];
end

end